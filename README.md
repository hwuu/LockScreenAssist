# 锁屏壁纸助手 (Lock Screen Quote Wallpaper)

一个自动生成名言警句锁屏壁纸的 HarmonyOS 应用，支持定时更新、智能选择和个性化定制。

## 功能特性

### 🕐 定时更新
- **多种频率选择**：支持每小时、每2小时、每4小时、每6小时、每12小时更新
- **定点更新**：支持每天特定时间更新（上午8点、中午12点、下午6点）
- **Crontab格式**：支持类似 Linux crontab 的时间表达式，精确到小时
- **后台运行**：即使应用不在前台，也能自动更新壁纸

### 🤖 智能选择算法
1. **随机选择**：从所有名言中随机选择
2. **根据季节**：根据当前季节选择相应的名言（春夏秋冬）
3. **根据天气**：根据天气情况选择匹配的名言（晴天、雨天、雪天等）
4. **智能选择**：综合考虑时间、季节、天气等因素，智能评分选择最合适的名言

### 🎨 自动优化
- **字体大小自适应**：根据名言长度自动调整字体大小，确保显示完整
- **背景色彩优化**：根据名言类别、季节、天气自动选择最佳配色方案
- **渐变背景**：支持美观的渐变色背景，提升视觉效果
- **文字对比度**：自动调整文字颜色确保良好的可读性

### 📱 用户界面
- **实时预览**：在应用中预览当前锁屏壁纸效果
- **一键更换**：点击按钮立即生成并应用新的壁纸
- **设置面板**：直观的设置界面，支持所有配置选项
- **壁纸信息**：显示当前壁纸的详细信息（类别、创建时间、季节等）

## 安装要求

- **系统版本**：HarmonyOS 5.1.1 或以上
- **设备类型**：手机
- **权限需求**：
  - 设置壁纸权限
  - 网络访问权限（获取天气信息）
  - 后台运行权限
  - 通知权限

## 使用方法

### 1. 基本使用
1. 安装并启动应用
2. 应用会自动生成第一张名言壁纸
3. 壁纸会自动应用到系统锁屏

### 2. 个性化设置
1. 点击右上角设置图标
2. 选择更新频率（默认每6小时）
3. 选择选择算法（推荐智能选择）
4. 开启或关闭自动优化功能
5. 点击"保存设置"

### 3. 手动更换
- 点击"立即更换"按钮手动生成新壁纸
- 点击"查看推荐"查看推荐的名言列表

## 后台运行机制

### 自动启动
应用采用多重机制确保后台持续运行：

1. **应用生命周期集成**：在应用启动时自动启动后台服务
2. **Worker线程**：使用独立的Worker线程执行定时任务
3. **定时器备份**：当Worker不可用时，自动降级到定时器方案
4. **重启恢复**：应用重新进入前台时自动检查并重启服务

### 后台权限
为了确保应用能在后台正常工作，需要用户授予以下权限：
- `ohos.permission.KEEP_BACKGROUND_RUNNING`：后台运行权限
- `ohos.permission.SET_WALLPAPER`：设置壁纸权限

## 名言数据库

应用内置丰富的名言警句数据库，包含：

### 分类
- **励志类**：激励人心的名言，适合早晨和工作时间
- **智慧类**：充满智慧的格言，适合学习和思考
- **诗词类**：优美的诗词名句，适合休闲时光
- **哲理类**：富含哲理的句子，适合深度思考

### 季节适配
- **春**：描写春天的诗词和积极向上的名言
- **夏**：适合夏日的清新励志句子
- **秋**：秋季收获和感悟相关的名言
- **冬**：冬日坚韧和温暖的句子

### 天气适配
- **晴天**：阳光积极的名言
- **雨天**：关于坚持和希望的句子
- **雪天**：关于纯洁和坚韧的名言

## 技术架构

### 核心模块
1. **QuoteData**：名言数据管理
2. **ScheduleConfig**：定时任务配置
3. **QuoteSelectionService**：名言选择服务
4. **WallpaperService**：壁纸生成服务
5. **BackgroundService**：后台服务管理

### 设计模式
- **服务层架构**：清晰的分层设计
- **配置驱动**：所有功能都支持配置化
- **策略模式**：选择算法可插拔
- **观察者模式**：状态变化通知

## 开发说明

### 项目结构
```
entry/src/main/ets/
├── common/           # 公共模块
│   ├── QuoteData.ets        # 名言数据
│   └── ScheduleConfig.ets   # 定时配置
├── services/         # 服务层
│   ├── QuoteSelectionService.ets  # 名言选择
│   ├── WallpaperService.ets       # 壁纸生成
│   └── BackgroundService.ets      # 后台服务
├── workers/          # Worker线程
│   └── BackgroundWorker.ts        # 后台任务处理
├── pages/            # 页面
│   └── Index.ets              # 主界面
└── entryability/     # 应用入口
    └── EntryAbility.ets       # 应用生命周期
```

### 扩展开发
1. **添加新名言**：在 `QuoteData.ets` 中添加新的名言数据
2. **自定义算法**：在 `QuoteSelectionService.ets` 中实现新的选择算法
3. **样式定制**：在 `WallpaperService.ets` 中修改样式生成逻辑
4. **新的触发时机**：在 `BackgroundWorker.ts` 中添加新的定时逻辑

## 常见问题

### Q: 为什么壁纸没有自动更新？
A: 请检查以下几点：
1. 确认已授予后台运行权限
2. 确认已授予设置壁纸权限
3. 检查系统是否限制了应用的后台活动
4. 重新启动应用重新初始化后台服务

### Q: 如何添加自定义名言？
A: 目前版本暂不支持用户自定义名言，后续版本会添加此功能。开发者可以通过修改 `QuoteData.ets` 文件来添加新的名言。

### Q: 壁纸文字显示不完整怎么办？
A: 应用会自动调整字体大小，如果仍有问题，可以关闭"自动优化字体"功能，系统会使用固定的字体大小。

### Q: 如何确保应用在后台持续运行？
A: 
1. 在系统设置中将应用添加到"后台应用管理"白名单
2. 关闭应用的"智能省电"功能
3. 确保应用有足够的电池使用权限

## 版本历史

### v1.0.0
- 基础功能实现
- 支持定时更新壁纸
- 多种选择算法
- 自动字体和背景优化
- 后台运行机制

## 许可证

本项目采用 MIT 许可证，详情请参见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来帮助改进这个项目。

## 联系方式

如有问题或建议，请通过 GitHub Issues 联系我们。